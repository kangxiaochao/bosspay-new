<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hyfd.dao.mp.ProviderDataDiscountDao">
	<sql id="Base_Column_List">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		id, provider_id, provider_physical_channel_id, name, discount,real_discount,
		data_pkg_id, province_code, city_code, update_date,
		update_user, create_date, create_user
	</sql>
	<select id="selectByPrimaryKey" parameterType="java.lang.String"
		resultType="java.util.Map">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select
		<include refid="Base_Column_List" />
		from mp_provider_data_discount
		where id = #{id,jdbcType=VARCHAR}
	</select>

	<select id="selectCount" resultType="Integer">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select
		count(1)
		from mp_provider_data_discount a LEFT JOIN mp_provider b on a.provider_id
		= b.id
		where 1 = 1
		<if test="providerId != null">
			and a.provider_id = #{providerId,jdbcType=VARCHAR}
		</if>
		<if test="providerPhysicalChannelId != null">
			and a.provider_physical_channel_id =
			#{providerPhysicalChannelId,jdbcType=VARCHAR}
		</if>
		<if test="name != null and name != '' ">
			and a.name like concat('%',#{name,jdbcType=VARCHAR},'%') 
		</if>
		<if test="discount != null">
			and a.discount = #{discount,jdbcType=DECIMAL}
		</if>
		<if test="realDiscount != null">
			and a.real_discount = #{realDiscount,jdbcType=DECIMAL}
		</if>
		<if test="dataPkgId != null">
			and a.data_pkg_id = #{dataPkgId,jdbcType=VARCHAR}
		</if>
		<if test="provinceCode != null">
			and a.province_code = #{provinceCode,jdbcType=VARCHAR}
		</if>
		<if test="cityCode != null">
			and a.city_code = #{cityCode,jdbcType=VARCHAR}
		</if>
		<if test="updateDate != null">
			and a.update_date = #{updateDate,jdbcType=TIMESTAMP}
		</if>
		<if test="updateUser != null">
			and a.update_user = #{updateUser,jdbcType=VARCHAR}
		</if>
		<if test="createDate != null">
			and a.create_date = #{createDate,jdbcType=TIMESTAMP}
		</if>
		<if test="createUser != null">
			and a.create_user = #{createUser,jdbcType=VARCHAR}
		</if>
		<if test="providerName != null and providerName != '' ">
			and b.name like concat('%',#{providerName,jdbcType=VARCHAR},'%') 
		</if>
	</select>
	<select id="selectAll" resultType="java.util.Map">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select
		a.*,b.`name` as providerName
		from mp_provider_data_discount a LEFT JOIN mp_provider b on
		a.provider_id = b.id
		where 1 = 1
		<if test="providerId != null">
			and a.provider_id = #{providerId,jdbcType=VARCHAR}
		</if>
		<if test="providerPhysicalChannelId != null">
			and a.provider_physical_channel_id =
			#{providerPhysicalChannelId,jdbcType=VARCHAR}
		</if>
		<if test="name != null and name != ''">
			and a.name like concat('%',#{name,jdbcType=VARCHAR},'%') 
		</if>
		<if test="discount != null">
			and a.discount = #{discount,jdbcType=DECIMAL}
		</if>
		<if test="realDiscount != null">
			and a.real_discount = #{realDiscount,jdbcType=DECIMAL}
		</if>
		<if test="dataPkgId != null">
			and a.data_pkg_id = #{dataPkgId,jdbcType=VARCHAR}
		</if>
		<if test="provinceCode != null">
			and a.province_code = #{provinceCode,jdbcType=VARCHAR}
		</if>
		<if test="cityCode != null">
			and a.city_code = #{cityCode,jdbcType=VARCHAR}
		</if>
		<if test="updateDate != null">
			and a.update_date = #{updateDate,jdbcType=TIMESTAMP}
		</if>
		<if test="updateUser != null">
			and a.update_user = #{updateUser,jdbcType=VARCHAR}
		</if>
		<if test="createDate != null">
			and a.create_date = #{createDate,jdbcType=TIMESTAMP}
		</if>
		<if test="createUser != null">
			and a.create_user = #{createUser,jdbcType=VARCHAR}
		</if>
		<if test="providerName != null and providerName != '' ">
			and b.name like concat('%',#{providerName,jdbcType=VARCHAR},'%') 
		</if>
		order by a.create_date desc
	</select>
	<delete id="deleteByPrimaryKey" parameterType="java.lang.String">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		delete from mp_provider_data_discount
		where id = #{id,jdbcType=VARCHAR}
	</delete>
	<insert id="insert" parameterType="java.util.Map">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into mp_provider_data_discount (id, provider_id,
		provider_physical_channel_id, name,
		discount, real_discount, data_pkg_id, province_code,
		city_code, update_date, update_user,
		create_date, create_user)
		values (#{id,jdbcType=VARCHAR}, #{providerId,jdbcType=VARCHAR},
		#{providerPhysicalChannelId,jdbcType=VARCHAR},
		#{name,jdbcType=VARCHAR},
		#{discount,jdbcType=DECIMAL}, #{realDiscount,jdbcType=DECIMAL}, #{dataPkgId,jdbcType=VARCHAR}, #{provinceCode,jdbcType=VARCHAR},
		#{cityCode,jdbcType=VARCHAR}, #{updateDate,jdbcType=TIMESTAMP},
		#{updateUser,jdbcType=VARCHAR},
		#{createDate,jdbcType=TIMESTAMP}, #{createUser,jdbcType=VARCHAR})
	</insert>
	<insert id="insertSelective" parameterType="java.util.Map">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into mp_provider_data_discount
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="id != null">
				id,
			</if>
			<if test="providerId != null">
				provider_id,
			</if>
			<if test="providerPhysicalChannelId != null">
				provider_physical_channel_id,
			</if>
			<if test="name != null">
				name,
			</if>
			<if test="discount != null">
				discount,
			</if>
			<if test="realDiscount != null">
				real_discount,
			</if>
			<if test="dataPkgId != null">
				data_pkg_id,
			</if>
			<if test="provinceCode != null">
				province_code,
			</if>
			<if test="cityCode != null">
				city_code,
			</if>
			<if test="updateDate != null">
				update_date,
			</if>
			<if test="updateUser != null">
				update_user,
			</if>
			<if test="createDate != null">
				create_date,
			</if>
			<if test="createUser != null">
				create_user,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="id != null">
				#{id,jdbcType=VARCHAR},
			</if>
			<if test="providerId != null">
				#{providerId,jdbcType=VARCHAR},
			</if>
			<if test="providerPhysicalChannelId != null">
				#{providerPhysicalChannelId,jdbcType=VARCHAR},
			</if>
			<if test="name != null">
				#{name,jdbcType=VARCHAR},
			</if>
			<if test="discount != null">
				#{discount,jdbcType=DECIMAL},
			</if>
			<if test="realDiscount != null">
				#{realDiscount,jdbcType=DECIMAL},
			</if>
			<if test="dataPkgId != null">
				#{dataPkgId,jdbcType=VARCHAR},
			</if>
			<if test="provinceCode != null">
				#{provinceCode,jdbcType=VARCHAR},
			</if>
			<if test="cityCode != null">
				#{cityCode,jdbcType=VARCHAR},
			</if>
			<if test="updateDate != null">
				#{updateDate,jdbcType=TIMESTAMP},
			</if>
			<if test="updateUser != null">
				#{updateUser,jdbcType=VARCHAR},
			</if>
			<if test="createDate != null">
				#{createDate,jdbcType=TIMESTAMP},
			</if>
			<if test="createUser != null">
				#{createUser,jdbcType=VARCHAR},
			</if>
		</trim>
	</insert>
	<update id="updateByPrimaryKeySelective" parameterType="java.util.Map">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		update mp_provider_data_discount
		<set>
			<if test="providerId != null">
				provider_id = #{providerId,jdbcType=VARCHAR},
			</if>
			<if test="providerPhysicalChannelId != null">
				provider_physical_channel_id = #{providerPhysicalChannelId,jdbcType=VARCHAR},
			</if>
			<if test="name != null">
				name = #{name,jdbcType=VARCHAR},
			</if>
			<if test="discount != null">
				discount = #{discount,jdbcType=DECIMAL},
			</if>
			<if test="realDiscount != null">
				real_discount = #{realDiscount,jdbcType=DECIMAL},
			</if>
			<if test="dataPkgId != null">
				data_pkg_id = #{dataPkgId,jdbcType=VARCHAR},
			</if>
			<if test="provinceCode != null">
				province_code = #{provinceCode,jdbcType=VARCHAR},
			</if>
			<if test="cityCode != null">
				city_code = #{cityCode,jdbcType=VARCHAR},
			</if>
			<if test="updateDate != null">
				update_date = #{updateDate,jdbcType=TIMESTAMP},
			</if>
			<if test="updateUser != null">
				update_user = #{updateUser,jdbcType=VARCHAR},
			</if>
			<if test="createDate != null">
				create_date = #{createDate,jdbcType=TIMESTAMP},
			</if>
			<if test="createUser != null">
				create_user = #{createUser,jdbcType=VARCHAR},
			</if>
		</set>
		where id = #{id,jdbcType=VARCHAR}
	</update>

	<select id="getProviderDataDiscountByDataPkgId" resultType="java.util.Map">
		select * from mp_provider_data_discount where
		data_pkg_id=#{data_pkg_id,jdbcType=VARCHAR}
	</select>

	<select id="getProviderDataDiscountByDataPkgIdAndProvinceId"
		resultType="java.util.Map">
		select * from mp_provider_data_discount where
		data_pkg_id=#{data_pkg_id,jdbcType=VARCHAR} and
		provider_id=#{providerId,jdbcType=VARCHAR}
	</select>

	<insert id="providerDataDiscountAdd">
		<selectKey keyProperty="myuuid" resultType="String" order="BEFORE">select
			replace(uuid(),'-','') as myuuid from dual</selectKey>
		insert into
		mp_provider_data_discount(id,provider_physical_channel_id,provider_id,name,discount,real_discount,data_pkg_id,province_code,create_date,create_user)
		VALUES(#{myuuid,jdbcType=VARCHAR},#{providerPhysicalChannelId,jdbcType=VARCHAR},#{providerId,jdbcType=VARCHAR},#{name,jdbcType=VARCHAR},#{discount,jdbcType=VARCHAR},
		#{realDiscount,jdbcType=VARCHAR},#{dataPkgId,jdbcType=VARCHAR},#{provinceCode,jdbcType=VARCHAR},CURRENT_TIMESTAMP,
		#{createUser,jdbcType=VARCHAR})
	</insert>

	<update id="providerDataDiscountEdit">
		update mp_provider_data_discount
		<set>
			discount=#{discount,jdbcType=VARCHAR},
			real_discount=#{realDiscount,jdbcType=VARCHAR},
			provider_physical_channel_id=#{providerPhysicalChannelId,jdbcType=VARCHAR},
			provider_id=#{providerId,jdbcType=VARCHAR},
			update_date=CURRENT_TIMESTAMP,
			update_user=#{updateUser,jdbcType=VARCHAR}
		</set>
		where id=#{id,jdbcType=VARCHAR}
	</update>

	<update id="providerDataDiscountEditByDataPkgId">
		update mp_provider_data_discount
		<set>
			discount=#{discount,jdbcType=VARCHAR},
			real_discount=#{realDiscount,jdbcType=VARCHAR},
			update_date=CURRENT_TIMESTAMP,
			update_user=#{updateUser,jdbcType=VARCHAR}
		</set>
		where data_pkg_id=#{dataPkgId,jdbcType=VARCHAR}
		and province_code=#{provinceCode,jdbcType=VARCHAR}
	</update>

	<update id="updateNameByDataPkgId">
		update mp_provider_data_discount
		<set>
			name = CONCAT(#{name,jdbcType=VARCHAR},'-',province_code)
		</set>
		where data_pkg_id=#{dataPkgId,jdbcType=VARCHAR}
	</update>

	<delete
		id="deleteProviderDataDiscountByProviderIdAndProviderPhysicalChannelId">
		delete 
			mp_provider_data_discount 
		from 
			mp_provider_data_discount,mp_data_pkg
		where 
			mp_provider_data_discount.data_pkg_id = mp_data_pkg.id
			and mp_data_pkg.data_type = #{dataType,jdbcType=VARCHAR}
		  	and provider_physical_channel_id=#{providerPhysicalChannelId,jdbcType=VARCHAR}
			and provider_id = #{providerId,jdbcType=VARCHAR}
	</delete>
	
	<delete
		id="deleteProviderDataDiscount">
		delete from mp_provider_data_discount
		where 
		  	provider_physical_channel_id=#{providerPhysicalChannelId,jdbcType=VARCHAR}
			and provider_id = #{providerId,jdbcType=VARCHAR}
			and province_code = #{provinceCode,jdbcType=VARCHAR}
	</delete>

	<select id="selectDiscount" resultType="java.lang.Double">
		select
		discount
		from mp_provider_data_discount where 1 = 1
		<if test="providerId != null">
			and provider_id = #{providerId,jdbcType=VARCHAR}
		</if>
		<if test="providerPhysicalChannelId != null">
			and provider_physical_channel_id =
			#{providerPhysicalChannelId,jdbcType=VARCHAR}
		</if>
		<if test="name != null">
			and name = #{name,jdbcType=VARCHAR}
		</if>
		<if test="discount != null">
			and discount = #{discount,jdbcType=DECIMAL}
		</if>
		<if test="dataPkgId != null">
			and data_pkg_id = #{dataPkgId,jdbcType=VARCHAR}
		</if>
		<if test="provinceCode != null">
			and province_code = #{provinceCode,jdbcType=VARCHAR}
		</if>
		<if test="cityCode != null">
			and city_code = #{cityCode,jdbcType=VARCHAR}
		</if>
		<if test="updateDate != null">
			and update_date = #{updateDate,jdbcType=TIMESTAMP}
		</if>
		<if test="updateUser != null">
			and update_user = #{updateUser,jdbcType=VARCHAR}
		</if>
		<if test="createDate != null">
			and create_date = #{createDate,jdbcType=TIMESTAMP}
		</if>
		<if test="createUser != null">
			and create_user = #{createUser,jdbcType=VARCHAR}
		</if>
	</select>
	<select id="selectDiscountMap" resultType="java.util.Map">
		select
		*
		from mp_provider_data_discount where 1 = 1
		<if test="providerId != null">
			and provider_id = #{providerId,jdbcType=VARCHAR}
		</if>
		<if test="providerPhysicalChannelId != null">
			and provider_physical_channel_id =
			#{providerPhysicalChannelId,jdbcType=VARCHAR}
		</if>
		<if test="name != null">
			and name like concat('%',#{name,jdbcType=VARCHAR},'%') 
		</if>
		<if test="discount != null">
			and discount = #{discount,jdbcType=DECIMAL}
		</if>
		<if test="dataPkgId != null">
			and data_pkg_id = #{dataPkgId,jdbcType=VARCHAR}
		</if>
		<if test="provinceCode != null">
			and province_code in ('全国',#{provinceCode,jdbcType=VARCHAR})
		</if>
		<if test="cityCode != null">
			and city_code = #{cityCode,jdbcType=VARCHAR}
		</if>
		<if test="updateDate != null">
			and update_date = #{updateDate,jdbcType=TIMESTAMP}
		</if>
		<if test="updateUser != null">
			and update_user = #{updateUser,jdbcType=VARCHAR}
		</if>
		<if test="createDate != null">
			and create_date = #{createDate,jdbcType=TIMESTAMP}
		</if>
		<if test="createUser != null">
			and create_user = #{createUser,jdbcType=VARCHAR}
		</if>
		group by discount
	</select>
	
	<select id="selectProvinceCode" resultType="java.util.Map">
		select 
			distinct a.province_code 
		from 
			mp_provider_data_discount a,mp_data_pkg b 
		where 
			a.provider_physical_channel_id = #{providerPhysicalChannelId,jdbcType=VARCHAR} 
			and a.provider_id = #{providerId,jdbcType=VARCHAR} 
			and a.data_pkg_id = b.id 
			and b.data_type= #{dataType,jdbcType=VARCHAR}
	</select>
	<select id="selectDataPkgAndDiscount" resultType="java.util.Map">
		select 
			*,b.`name` as dataPkgName 
		from 
			mp_provider_data_discount a,mp_data_pkg b 
		where 
			a.provider_physical_channel_id = #{providerPhysicalChannelId,jdbcType=VARCHAR} 
			and a.provider_id = #{providerId,jdbcType=VARCHAR} 
			and a.province_code = #{provinceCode,jdbcType=VARCHAR}
			and a.data_pkg_id = b.id
			and b.data_type= #{dataType,jdbcType=VARCHAR}
	</select>
</mapper>